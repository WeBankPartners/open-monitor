# Open-Monitor 用户手册

## <span id="menu_introdution"></span>主菜单介绍
![主页面](images/user_guide/user_guide_01.png)  
Open-Monitor的功能总体分为: 视图、配置、告警展示。下面详细介绍每个菜单下的每个功能。

## <span id="dashboard"></span>视图  
视图包括 对象视图、指标配置、自定义视图。
### <span id="endpoint_dashboard"></span>对象视图  
对象视图可以快速地展示各类型监控对象的基础监控指标，包括主机、Mysql、Redis、Tomcat等
![对象视图菜单](images/user_guide/user_guide_02.png)  
![对象视图页面01](images/user_guide/user_guide_07.png)  
1、可根据ip或主机名实例名来模糊搜索监控对象  
2、可选择视图展示的时间区间  
3、可选择视图展示的日期区间  
4、可选择定时刷新的时间间隔  
5、可快速跳转到该对象告警配置页面  
6、可切换中英文显示  
7、可切换视图页查看主机磁盘指标视图  
8、可切换视图页查看主机网络指标视图  
9、可放大图表  
10、点击后可在图表上拖拉图表区间  
11、点击后可恢复图表区间  

![对象视图页面02](images/user_guide/user_guide_09.png) 
12、可选择视图展示的时间区间  
13、可选择视图展示的日期区间  
14、可选择视图聚合的方式，聚合是指把多个点合成一个点来减少显示点数，加快图表显示  
15、点击后可在图表上拖拉图表区间  
16、点击后可恢复图表区间  

### <span id="metric_config"></span>指标配置  
指标配置可以配置监控指标名与Prometheus表达式的映射关系，并且可以配置对象视图的指标展示  
![指标配置页面01](images/user_guide/user_guide_22.png)
1、选择监控对象类型，因为指标是归属于某一类监控对象的  
2、可选择已有的指标，也可以在这新增和删除指标  
3、点击搜索可列出已选指标的配置内容  
4、配置指标的名称，该指标名称会在open-monitor中的视图与告警中使用  
5、(可选)如果要查看某个监控对象的Prometheus采集数据，可选择一个监控对象，该选择会影响下面的采集数据下拉列表  
6、(可选)选取了上面的监控对象后会列出该对象的采集数据，可选择用来快速生成下面的指标表达式而不用手动输入  
7、在此可以配置PromQL，其实整个指标配置的功能就是为了给Prometheus表达式做一次映射，为的是能在视图和告警管理中有更直观的指标定义  
8、点击预览可以通过选取一个监控对象来查看配置的Prometheus表达式所查询的数据图表  
9、保存上面的配置  
10、进入到对象视图分组配置界面  

![指标配置页面02](images/user_guide/user_guide_23.png)
1、选择该对象类型的对象视图的图表分组，就是对应的对象视图上的tab切换分组，可在此新增修改删除分组  
2、选择分组里的具体哪个图表，可在此新增或删除图表，选取了之后下面的表单会带出已配置的图表内容  
3、图表的标题名称  
4、图表内的数据单位  
5、选择图表内数据浮动显示的内容结构  
6、选择图表内要显示的指标，可多选  
7、点击预览可以通过选取一个监控对象来查看图表  
8、保存上面的配置    

### <span id="custom_dashboard"></span>自定义视图
自定义视图提供可让用户自行配置图表主页的编辑界面，可拖拽图表大小，可配置各个图表内容  
![自定义视图页面01](images/user_guide/user_guide_11.png)
1、新增一个视图模板  
2、可设置某个自定义视图为首页  
3、查看自定义视图，进入编辑页面  
4、删除视图  
5、设置为首页的视图会有个星星标记 
 
![自定义视图页面02](images/user_guide/user_guide_12.png)
1、可修改图表的标题
2、点击可进入图表配置界面  
3、可删除该图表  
4、新增图表  
5、保存修改  
6、返回到自定义视图选择页面  
7、可拖拉该图表位置  

![自定义视图页面03](images/user_guide/user_guide_13.png)
1、图表的曲线配置  
2、图表的标题和单位配置  
3、可根据ip或主机名实例名来模糊搜索监控对象  
4、可选择该监控对象上已配置好的指标名  
5、点确定后可增加该对象指标的曲线到上面的图表上  
6、可删除已增加的对象指标  
7、保存配置  
8、返回到上一个页面  

## <span id="alarm_config"></span>告警配置
告警配置提供对象管理、层级对象管理、组管理、阀值配置、日志关键字告警配置、采集器配置、业务监控配置等功能
![告警配置页面01](images/user_guide/user_guide_24.png)
1、监控对象管理，监控对象是open-monitor里最基础的监控单位，可以是一台主机一个应用进程之类的  
2、层级对象管理，层级对象是业务层面的对象，而上面的监控对象是技术层的对象，该层级对象可以包含多个监控对象，可通过层级对象快速查看应用的监控视图，如下图所示：  
![层级对象说明](images/user_guide/user_guide_25.png)
3、监控对象组配置管理，一组监控对象的集合，可对组直接配置阈值让其组内的监控对象生效  
4、阈值配置是可选择某个监控对象或某个组来配置一组告警的策略  
5、日志关键字告警配置是可以在某个主机监控对象的基础上，监控该主机上的某个文件输出是否包含有配置的关键字出现，如果有则会产生告警  
6、采集器配置是配置特殊采集方式的监控，比如说k8s和snmp，它们都不单单只是起个exporter就可以监控那么简单，所以这里专门加了采集器配置这一项  
7、业务监控配置是在某个主机监控对象的基础上，通过配置的正则规则来识别某一文件的输出内容，然后解析内容生成监控指标数据，通过日志的方式来无侵入式地采集业务系统的业务指标数据    

### <span id="endpoint_config"></span>监控对象管理
![对象管理页面01](images/user_guide/user_guide_14.png)
1、监控对象管理  
2、对象组管理  
3、阀值配置管理  
4、日志告警配置管理  
5、可根据ip或主机名实例名来模糊搜索监控对象  
6、新增告警对象
7、点击跳转到阀值配置页面  
8、点击查看该对象历史告警  
9、点击跳转到日志告警配置页面  
![对象管理页面02](images/user_guide/user_guide_15.png)
10、选择监控对象类型  
11、填入对象agent的ip  
12、填入对象agent的端口  

### <span id="group_config"></span>对象组管理
![组管理页面01](images/user_guide/user_guide_16.png)
1、可跳转到对象管理页面，查看该组内的对象，可在那增加删除成员对象  
2、可跳转到阀值页面给组配置阀值策略，会对该组内的所有对象都生效  
3、可编辑组的名称和描述  
4、可删除该组  
5、可跳转到日志告警页面给组配置日志告警，会对该组内的所有对象都生效  

### <span id="threshold_config"></span>阀值配置
![阀值配置页面01](images/user_guide/user_guide_17.png)
1、可选择是对象还是组  
2、可模糊搜索对象或组  
3、组名，如果所选择是对象，会把它所属组的策略也给显示出来，但是不能修改组的策略  
4、对象名  
5、可以给对象增加阀值策略  
6、编辑阀值策略  
7、删除阀值策略  
![阀值配置页面02](images/user_guide/user_guide_18.png)
8、可选择指标  
9、选好指标后会自动带出已在指标配置上配置好的Prometheus表达式  
10、填写通知内容  
11、选择条件  
12、填写阀值  
13、持续异常时间数值  
14、时间单位  
15、告警级别，有高中低三个级别  

### <span id="log_monitor_config"></span>日志告警配置
![日志告警配置页面01](images/user_guide/user_guide_19.png)
1、可选择是对象还是组  
2、可模糊搜索对象或组  
3、可新增日志告警配置  
4、新增该日志路径下的关键字告警  
5、编辑该告警配置  
6、删除配置  
![日志告警配置页面02](images/user_guide/user_guide_20.png)
7、日志里的关键字  
8、关键字出现条件  
9、关键字出现次数  
10、持续异常时间数值  
11、时间单位  
12、告警级别，有高中低三个级别   

## <span id="alarm_dashboard"></span>告警视图
![未恢复告警页面01](images/user_guide/user_guide_21.png)
1、页面会每10秒刷新，此处显示上次刷新时间  
2、该标签上的加号可点击给该页面的告警显示增加过滤条件  
3、可手动删除某条告警  
4、点击可展开告警详细信息  

